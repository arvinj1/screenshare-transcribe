# NOTE: project_key is unknown — fill in before importing to Jira.
# Generated by IntentForge Jira Builder from approved plan.yaml

epic:
  project_key: ""  # FILL IN
  issue_type: "Epic"
  summary: "Add audio alignment to screenshare transcription pipeline"
  description: >
    Pair real-time audio transcription with the existing OCR pipeline so
    users get a time-synced view of what was shown on screen alongside
    what was said. Uses the browser-native Web Speech API — zero new
    dependencies. Includes graceful fallback to OCR-only mode when
    microphone permission is denied or SpeechRecognition is unavailable.
  labels:
    - "audio-alignment"
    - "feature"
  components: []
  priority: "Medium"

stories:
  - key_suffix: "T1"
    issue_type: "Task"
    summary: "Add AudioSegment type definition"
    description: >
      Add AudioSegment interface to the shared types module.
      Fields: id (string), timestamp (number), text (string),
      isFinal (boolean), confidence (number).
    acceptance_criteria:
      - "AudioSegment interface exists in src/types/index.ts"
      - "Type is exported and importable by other modules"
    estimate: "XS"
    labels: ["audio-alignment"]

  - key_suffix: "T2"
    issue_type: "Story"
    summary: "Create useAudioCapture hook for mic capture + speech-to-text"
    description: >
      New React hook that requests microphone access, instantiates the
      Web Speech API (SpeechRecognition), and emits timestamped
      AudioSegment objects via callback. Exposes startAudio(),
      stopAudio(), isListening, and audioError.
    acceptance_criteria:
      - "Microphone permission is requested when startAudio() is called"
      - "Speech recognition runs continuously with interim results"
      - "Final transcript segments are emitted as AudioSegment objects with timestamps"
      - "If mic permission is denied, audioError is set and no crash occurs"
      - "If SpeechRecognition is unavailable, audioError is set gracefully"
      - "stopAudio() cleanly stops recognition and releases mic"
    estimate: "S"
    labels: ["audio-alignment"]

  - key_suffix: "T3"
    issue_type: "Story"
    summary: "Wire audio capture into App.tsx alongside screen capture"
    description: >
      Integrate useAudioCapture into the main App component. Start audio
      when screen sharing starts, stop when sharing stops. Collect
      AudioSegment[] in state and pass to child components.
    acceptance_criteria:
      - "Audio capture starts automatically when screen sharing begins"
      - "Audio capture stops when screen sharing stops"
      - "audioSegments state is maintained and passed to MainLayout and SummaryView"
      - "App continues to function if audio capture fails (OCR-only fallback)"
    estimate: "S"
    labels: ["audio-alignment"]

  - key_suffix: "T4"
    issue_type: "Task"
    summary: "Create AudioSegmentItem UI component"
    description: >
      New component to render a single audio transcript segment. Visually
      distinct from OCR items — uses audio/mic badge instead of slide badge.
      Shows timestamp, transcript text, and final/interim indicator.
    acceptance_criteria:
      - "Component renders audio segment text with timestamp"
      - "Visually distinguishable from OCR result items (different badge/color)"
      - "Interim segments shown with a visual indicator (e.g., italic or muted)"
    estimate: "XS"
    labels: ["audio-alignment"]

  - key_suffix: "T5"
    issue_type: "Story"
    summary: "Interleave audio segments with OCR results in transcript panel"
    description: >
      Modify OCRPanel and OCRResultList to accept and display both OCR
      results and audio segments, sorted by timestamp. Each entry type is
      visually distinguishable.
    acceptance_criteria:
      - "OCRPanel accepts audioSegments prop"
      - "Results list interleaves OCR and audio items sorted by timestamp"
      - "OCR items use existing styling; audio items use AudioSegmentItem"
      - "List auto-scrolls to latest entry regardless of type"
    estimate: "S"
    labels: ["audio-alignment"]

  - key_suffix: "T6"
    issue_type: "Task"
    summary: "Update MainLayout to forward audioSegments to OCRPanel"
    description: >
      Add audioSegments prop to MainLayout and pass through to OCRPanel.
    acceptance_criteria:
      - "MainLayout accepts and forwards audioSegments prop"
      - "No visual regression when audioSegments is empty"
    estimate: "XS"
    labels: ["audio-alignment"]

  - key_suffix: "T7"
    issue_type: "Story"
    summary: "Include audio transcript in session summary generation"
    description: >
      Modify useSummary to accept audioSegments, concatenate audio
      transcript with OCR text for inference, and track audio-specific
      stats (audioWordCount, audioSegmentCount).
    acceptance_criteria:
      - "generateSummary accepts audioSegments parameter"
      - "Audio transcript text is included in inference input"
      - "SessionSummary includes audioWordCount and audioSegmentCount"
      - "Summary still works correctly with zero audio segments"
    estimate: "S"
    labels: ["audio-alignment"]

  - key_suffix: "T8"
    issue_type: "Task"
    summary: "Display audio stats and transcript in SummaryView"
    description: >
      Show audio segment count, audio word count in the statistics
      section. Add a collapsible section with the full audio transcript.
    acceptance_criteria:
      - "Audio stats appear in the statistics grid when audio data exists"
      - "Full audio transcript is available in a collapsible section"
      - "No visual change when there is no audio data"
    estimate: "XS"
    labels: ["audio-alignment"]

  - key_suffix: "T9"
    issue_type: "Task"
    summary: "Add mic status indicator to Header"
    description: >
      Show a mic icon in the header when audio capture is active.
      Show a warning indicator if audio permission was denied.
    acceptance_criteria:
      - "Mic icon visible in header during active audio capture"
      - "Warning shown if mic permission denied"
      - "No indicator shown when not sharing"
    estimate: "XS"
    labels: ["audio-alignment"]
